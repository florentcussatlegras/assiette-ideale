{% extends "base.html.twig" %}

{% form_theme profileForm "form/_custom_profile_themes.html.twig" %}

{% block title %}{{ parent() }} - Mon profil{% endblock %}

{% block body %}

	<main role="main">

		<div class="mb-4 md:mb-8">
			{{ include("partials/_header.html.twig", { h1_content: "Mon profil" }) }}
		</div>

		<div class="flex justify-center items-start">

			<div class="flex flex-row lg:flex-col w-full">

				{% if app.user.firstFillProfile is same as (false) %}

					<ol class="flex flex-col lg:flex-row items-start lg:items-center text-xs md:text-sm font-medium text-center text-gray-500 mx-auto lg:mt-6 pb-6 gap-2 lg:gap-0 mb-0 md:mb-18">

						{% set steps, lastValidStep = constant('App\\Service\\ProfileHandler::STEPS'), app.user.validStepProfiles|last %}
						{% set currentStep = element %}
						{% for key, step in steps %}
							{% if step == lastValidStep %}
								{% set currentStep = steps[key + 1] %}
							{% endif %}
						{% endfor %}

						{% for key, step in steps %}

							<li class="my-hidden lg:flex items-start lg:items-center leading-4 justify-center">
								{% if loop.index0 %}
									<div class="flex items-center justify-center px-2 my-hidden lg:flex">
										<svg xmlns="http://www.w3.org/2000/svg" fill="none" height="20" width="20" viewbox="0 0 24 24" class="text-slate-400" stroke="currentColor">
											<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
										</svg>
									</div>
								{% endif %}
								{% if step is same as (element) %}
									<a href="{{ path('app_profile_edit', { element: step }) }}" class="text-base lg:text-sm 2xl:text-base text-light-blue font-bold uppercase text-center">
										{{ "profile.stepper_registration.#{step}"|trans({}, 'profile') }}
									</a>
								{% elseif step in app.user.validStepProfiles or step == currentStep %}
									<a href="{{ path('app_profile_edit', { element: step }) }}" class="text-base lg:text-sm 2xl:text-base font-bold uppercase text-center">
										{{ "profile.stepper_registration.#{step}"|trans({}, 'profile') }}
									</a>
								{% else %}
									<span class="text-base lg:text-sm 2xl:text-base font-bold uppercase text-center">{{ "profile.stepper_registration.#{step}"|trans({}, 'profile') }}</span>
								{% endif %}
							</li>

							<li class="flex items-start lg:items-center leading-4 justify-center lg:hidden">
								{% if loop.index0 %}
									<div class="flex items-center justify-center px-2 my-hidden lg:flex">
										<svg xmlns="http://www.w3.org/2000/svg" fill="none" height="20" width="20" viewbox="0 0 24 24" class="text-slate-400" stroke="currentColor">
											<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
										</svg>
									</div>
								{% endif %}
								{% if step is same as (element) %}
									<a href="{{ path('app_profile_edit', { element: step }) }}" class="text-base lg:text-sm 2xl:text-base text-light-blue font-bold uppercase text-left">
										{{ "profile.stepper_registration.#{step}"|trans({}, 'profile') }}
									</a>
								{% elseif step in app.user.validStepProfiles or step == currentStep %}
									<a href="{{ path('app_profile_edit', { element: step }) }}" class="text-base lg:text-sm 2xl:text-base font-bold uppercase text-left">
										{{ "profile.stepper_registration.#{step}"|trans({}, 'profile') }}
									</a>
								{% else %}
									<span class="text-base lg:text-sm 2xl:text-base font-bold uppercase text-left">{{ "profile.stepper_registration.#{step}"|trans({}, 'profile') }}</span>
								{% endif %}
							</li>

						{% endfor %}

					</ol>

				{% endif %}

				<div class="p-4 profileForm mx-auto my-5 bg-white flex flex-col justify-center mt-0 rounded-2xl shadow-soft" {{ stimulus_controller('profile') }}>

					{{ form_start(profileForm, {'attr': {'action' : path('app_profile_edit', { element }), 'class' : 'w-full'}}) }}

					{{ form_widget(profileForm) }}

					{% if app.session.has('user_error_pic') %}
						<span class="text-red-700">
							{{ render(controller('App\\Controller\\ProfileController::showErrorPicture')) }}
						</span>
					{% endif %}

					{{ include('profile/partials/_btn_nav.html.twig') }}

					{{ form_end(profileForm, { render_rest: false }) }}

				</div>

			</div>

		</div>

	</main>

{% endblock %}

{# {% block javascripts %} #}

{# {{ parent() }}

    <script src="{{ asset('js/image.js') }}"></script> #}
{# <script src="{{ asset('js/energy.js') }}"></script> #}

{# {% endblock %} #}
