{% extends "base.html.twig" %}

{% block title %}{{ parent() }} - Les plats{% endblock %}

{% block body %}

    <main role="main">

        <div
            {{ stimulus_controller('reload-content', {
                'url': path('app_dish_list'),
                'urlListRemoveFavoriteDish': path('app_favorite_dishes_remove'),
                'type-dish': 'type.dish.all'
            }) }}
        >

            <div class="flex justify-between items-center">
                {% if favoriteDishesId is defined %}
                    {{ include("partials/_header.html.twig", { h1_content: "Les plats" }) }}
                    {# <div class-"flex ml-auto w-1-3 justify-end mb-3"> #}
                        <a class="link-white flex items-center justify-center gap-2 ml-auto text-center px-2 py-2 leaning-4 font-bold text-md md:text-base text-white bg-sky-600 hover:bg-sky-700 transition duration-300 rounded-lg w-[250px]" href="{{ path('app_dish_food_session_clear') }}"> 
                            {# <svg viewBox="0 0 24 24" class="w-6 h-6" fill="#ffffff" data-v-563d9226=""><path d="M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" data-v-563d9226=""></path></svg> #}
                            <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g id="Edit / Add_Plus"> <path id="Vector" d="M6 12H12M12 12H18M12 12V18M12 12V6" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g> </g></svg>
                            Saisir une recette
                        </a>
                    {# </div> #}
                {% else %}
                    {{ include("partials/_header.html.twig", { h1_content: "Vos plats préférés" }) }}
                {% endif %}
            </div>

            <div>

                {% if favoriteDishesId is defined %}

                    <div class="flex flex-col gap-2 items-start">
									
                        <div class="flex flex-row gap-2 items-center">
                            <button
                                type="button"
                                data-action="reload-content#onSelectAllFoodGroup"
                                data-reload-content-target="selectAllFoodGroup"
                                class="flex items-center justify-center py-3 px-4 gap-2 font-semibold text-sm leading-4 cursor-pointer rounded-lg text-white bg-light-blue hover:text-white hover:bg-sky-600 transition-colors duration-300"
                            >
                                {# <svg fill="#fff" viewBox="0 0 24 24" class="w-5 h-5" id="add-collection" data-name="Line Color" xmlns="http://www.w3.org/2000/svg" class="icon line-color" stroke="#fff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path id="secondary" d="M7,10h6M10,7v6" style="fill: none; stroke: #fff; stroke-linecap: round; stroke-linejoin: round; stroke-width: 2;"></path><path id="primary" d="M7,21H20a1,1,0,0,0,1-1V5" style="fill: none; stroke: #fff; stroke-linecap: round; stroke-linejoin: round; stroke-width: 2;"></path><rect id="primary-2" data-name="primary" x="3" y="3" width="14" height="14" rx="1" style="fill: none; stroke: #fff; stroke-linecap: round; stroke-linejoin: round; stroke-width: 2;"></rect></g></svg> #}
                                <span>Tous les groupes</span>
                            </button>
                            <button 
                                type="button" 
                                data-action="reload-content#onDeselectAllFoodGroup"
                                data-reload-content-target="deselectAllFoodGroup"
                                class="flex items-center justify-center py-3 px-4 gap-2 font-semibold text-sm leading-4 cursor-pointer rounded-lg bg-white text-dark-blue hover:text-white hover:bg-sky-600 transition-colors duration-300"
                            >
                                {# <svg fill="#fff" viewBox="0 0 24 24" class="w-5 h-5" id="minus-collection" data-name="Line Color" xmlns="http://www.w3.org/2000/svg" class="icon line-color" stroke="#fff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><line id="secondary" x1="7" y1="10" x2="13" y2="10" style="fill: none; stroke: #fff; stroke-linecap: round; stroke-linejoin: round; stroke-width: 2;"></line><path id="primary" d="M7,21H20a1,1,0,0,0,1-1V5" style="fill: none; stroke: #fff; stroke-linecap: round; stroke-linejoin: round; stroke-width: 2;"></path><rect id="primary-2" data-name="primary" x="3" y="3" width="14" height="14" rx="1" style="fill: none; stroke: #fff; stroke-linecap: round; stroke-linejoin: round; stroke-width: 2;"></rect></g></svg> #}
                                <span>Aucun groupe</span>
                            </button>
                        </div>

                        <div class="flex flex-row flex-wrap gap-2">
                            {{ include('/foodgroup/_foodgroup_list.html.twig') }}
                        </div>

                    </div>

                    <div class="flex flex-col gap-4 xl:gap-0 items-start xl:flex-row mt-4 justify-start xl:items-center lg:justify-between w-full xl:h-8">

                        <div class="relative search_dish_list w-full md:w-1/2">
                            <input
                                id="input_search_dish_list"
                                name="q"
                                placeholder="Saisissez le nom d'un aliment ou d'un plat"
                                type="search"
                                class="block p-6 border-none w-full xl:w-2/3 rounded-lg"
                                data-reload-content-target="search"
                                data-action="reload-content#onSearchInput"
                            >
                        </div>

                        <div class="flex flex-col justify-start md:flex-row gap-4 md:gap-0 w-full">

                            <div class="flex items-center">
                                <button 
                                    type="button"
                                    class="leading-4 btn-type-dish py-3 px-4 font-semibold tabs-date-range_tab bg-light-blue text-white mr-2 text-sm cursor-pointer rounded-lg hover:text-white hover:bg-sky-600 transition-colors duration-300"
                                    data-reload-content-target="typeDish"
                                    data-action="reload-content#onSelectTypeDish"
                                    data-type-dish="type.dish.all"
                                >
                                    Tous
                                </button>
                                {% for type in constant('App\\Service\\TypeDishHandler::TYPE_NAMES') %}
                                    <button 
                                        type="button"
                                        class="leading-4 btn-type-dish py-3 px-4 font-semibold tabs-date-range_tab bg-white text-dark-blue mr-2 text-sm cursor-pointer rounded-lg hover:text-white hover:bg-sky-600 transition-colors duration-300" 
                                        data-reload-content-target="typeDish"
                                        data-action="reload-content#onSelectTypeDish"
                                        data-type-dish="{{ type }}"
                                    >
                                        {{ type|trans({}, 'dishes')|capitalize }}
                                    </button>
                                {% endfor %}
                            </div>

                            <div class="flex items-center ml-0 md:ml-auto lg:ml-16 mr-4 gap-2">
                                {{ include('meals/partials/_button_gluten_lactose.html.twig') }}
                            </div>

                            <div class="my-hidden lg:flex h-8 md:h-10 xl:h-11 ml-auto">
                                {{ include('partials/_view_mode_list.html.twig') }}
                            </div>

                        </div>

                    </div>

                {# {% else %} #}

                    {# {% if dishes is not empty %}
                        <div class="flex h-8 md:h-10 xl:h-11 ml-0 md:ml-auto">
                            {{ include('partials/_view_mode_list.html.twig') }}
                        </div>
                    {% endif %} #}

                {% endif %}

                <div 
                    {{ stimulus_controller('favorite-dishes', {
                        'url': path('app_favorite_dishes_list', {'ajax': 1}),
                        'urlAdd': path('app_favorite_dishes_add'),
                        'urlRemove': path('app_favorite_dishes_remove')
                    }) }}
                >
                    <div 
                        id="wrapper" 
                        class="wrapper gap-4 mt-8 relative min-h-64"
                        data-loading="addClass(opacity-50)"
                        data-reload-content-target="content"
                        data-favorite-dishes-target="content"
                    >     
                        {{ include('dish/_dish_list.html.twig') }}
                    </div>

                </div>

                {% if favoriteDishesId is defined %}

                    <div 
                        {# class="container-loader w-full h- items-center justify-center mt-5 hidden py-8" #}
                        class="container-loader w-full h- items-center justify-center mt-24 xl:mt-32 hidden flex py-8"
                        data-reload-content-target="loader"
                    >
                        <div class="loader"></div>
                    </div>

                    <center class="mt-8 mb-8">
                        <button 
                            type="button"
                            class="bg-gray-200 px-4 py-2 h-10 text-sm rounded-lg text-gray-500 hover:text-gray-900 transition duration-300"
                            data-action="reload-content#onLoadMore"
                            data-reload-content-target="loadMore"
                        >
                            Voir plus de plat...
                        </button>
                    </center>

                {% endif %}

                    {# <div class="container-load-more flex flex-col items-center h-full hidden">
                        
                        <div class="flex flex-col items-center justify-center w-full h-full">
                            <div class="no-result text-sky-400">
                                Aucun résultat
                            </div>
                            <img class="loading-spinner hidden" src="{{ absolute_url(asset('images/loading.svg')) }}" alt="Loading spinner" />
                        </div>

                    </div> #}

                <script> 
                    const wrapper = document.getElementById("wrapper");
                    const btnModeList = document.getElementById("view-mode-list");
                    const btnModeGrid = document.getElementById("view-mode-grid");

                    btnModeList.addEventListener("click", function (event) {
                        // List view
                        event.preventDefault();
                        wrapper.classList.add("list");
                        btnModeGrid.classList.remove("view-mode-switch__display--selected")
                        this.classList.add("view-mode-switch__display--selected");
                    });

                    btnModeGrid.addEventListener("click", function (event) {
                        // Grid view
                        event.preventDefault();
                        wrapper.classList.remove("list");
                        btnModeList.classList.remove("view-mode-switch__display--selected");
                        this.classList.add("view-mode-switch__display--selected");
                    });
                </script>

            </div>

        </div>

    </main>

{% endblock %}