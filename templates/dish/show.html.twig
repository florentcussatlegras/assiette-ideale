{% extends "base.html.twig" %}

{% block title %}{{ parent() }} - Les plats{% endblock %}

{% block body %}

    <div class="py-12">

        {% set title = dish.name %}

        <div class="flex flex-col">
            <div class="flex flex-row items-center gap-2">
                {{ include('navigation/_breadcrumb_dashboard.html.twig')  }}
                {{ title }}
            </div>

            <h1 class="text-2xl md:text-4xl font-bold">
                {{ include('navigation/_title.html.twig') }}
            </h1>
        </div>

        <div class="bg-white px-6 flex flex-col lg:flex-row py-5 w-full shadow-lg rounded-xl">

            <div class="flex flex-col md:flex-row lg:flex-col 2xl:flex-row w-full lg:w-1/2">

                <div class="flex flex-col w-full md:w-1/2 lg:w-full 2xl:w-1/2 mb-4">

                    <div class="flex flex-row justify-between mb-2">

                        <span class="flex items-center text-lg px-4 font-bold bg-slate-200 uppercase rounded">
                            {{ dish.level|trans({}, 'recipe') }}
                        </span>

                            {% if is_granted('ROLE_ADMIN') %}

                                <div class="flex items-center ml-auto gap-2">

                                    <a href="{{ path('app_dish_food_session_clear', { id : dish.id }) }}">
                                        {{ include("partials/svg/edit.html.twig") }}
                                    </a>

                                    <a href="{{ path('app_dish_remove', { id : dish.id }) }}">
                                        {{ include("partials/svg/remove.html.twig") }}
                                    </a>

                                </div>

                            {% endif %}
                            
                    </div>

                    <div>
                        {% if dish.picture is empty %}
                            <img class="w-full h-64 image-fit" src="https://via.placeholder.com/800">
                        {% else %}
                            <img alt="Image plat" class="image-fit" src="{{ dish.picturePath|imagine_filter('squared_thumbnail_medium') }}">
                        {% endif %}
                    </div>
                </div>

                <div class="flex flex-col items-start pt-2 w-full md:w-1/2 lg:w-full 2xl:w-1/2 ml-0 md:ml-6 lg:ml-0 2xl:ml-6 mb-4">
                    
                    <h1 class="text-xl font-bold mt-5">Ingrédients</h1>
                    <label class="text-sm">{{ 'recipe.person'|trans({'length' : dish.lengthPersonForRecipe}, 'recipe') }}</label>
            
                    <ul class="font-normal mt-0 text-base">
                        {% for dishFood in dish.dishFoods %}
                            <li class="flex items-center gap-2">
                                <span class="w-2 h-2 rounded-sm" style="border: 1px solid {{ dishFood.food.foodGroup.parent.color }}; background-color: {{ dishFood.food.foodGroup.parent.color }}"></span>
                                {{ dishFood.quantityReal }} {{ dishFood.unitMeasure.alias }} de <a href="{{ path('app_food_show', {slug: dishFood.food.slug}) }}" class="text-sky-600">{{ dishFood.food.name }}</a>
                            </li>
                        {% endfor %}
                        {% for spice in dish.spices %}
                            <li>{{ spice.name }}</li> 
                        {% endfor %}
                    </ul>
                    
                    <div class="flex gap-2 mt-2 text-sm">
                        <span class="font-bold bg-yellow-100 text-yellow-800 px-4 py-1 rounded uppercase">
                        {% if dish.haveGluten %}
                            Avec gluten
                        {% else %}
                            Sans gluten
                        {% endif %}
                        </span>
                        <span class="font-bold bg-slate-100 text-sky-800 px-4 py-1 rounded uppercase">
                        {% if dish.haveLactose %}
                            Avec lactose
                        {% else %}
                            Sans lactose
                        {% endif %}
                        </span>
                    </div>

                </div>

            </div>

            {% if dish.stepRecipes|length > 0 %}

                <div class="flex flex-col pt-2 w-full lg:w-1/2 text-base">
        
                    <h1 class="text-xl font-bold mt-5 mb-2">Préparation</h1>

                    {% if dish.preparationTimeUnitTime is not null %}           
                        <div class="flex gap-3 items-center">
                        
                            <label>{{ 'recipe.time.label.preparation'|trans({}, 'recipe') }} : </label>
                            <span class="font-normal">
                                {{ 'recipe.time.value'|trans({'duration' : dish.preparationTime, 'unit_time' : dish.preparationTimeUnitTime.alias}, 'recipe') }}
                            </span>
                        </div>
                    {% endif %}

                    {% if dish.cookingTimeUnitTime is not null %} 

                        <div class="flex gap-2 items-center mb-2">
                            <label>{{ 'recipe.time.label.cooking'|trans({}, 'recipe') }} : </label>
                            <span class="font-normal">
                                {{ 'recipe.time.value'|trans({'duration' : dish.cookingTime, 'unit_time' : dish.cookingTimeUnitTime.alias}, 'recipe') }}
                            </span>
                        </div>

                    {% endif %}

                    {% for stepRecipe in dish.stepRecipes %}
                        <div class="flex items-start gap-2">
                            <span class="font-bold text-slate-300">{{ stepRecipe.rankStep }}</span>
                            <span>{{ stepRecipe.description|raw }}</span>
                        </div>
                    {% endfor %}

                    <div class="mt-4">
                        {{ include('dish/_nutritional_values.html.twig', { ignore_missing: true }) }}
                    </div>

                </div>

            {% endif %}

        </div>

    </div>

{% endblock %}

