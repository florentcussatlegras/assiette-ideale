
<div class="container-advice basis-1/6 text-sm w-full">

	{% if alerts is empty %}

		<button class="flex items-center text-green-500 advice text-sm px-2 font-bold w-full justify-center">
			{# <svg class="w-4 h-4 mr-1.5 dark:text-green-400 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg> #}
			<span>Conseillé</span>
		</button>

	{% else %}

		{% set strNotAlreadyNotRecommended, strAlreadyNotRecommended = '', '' %}

		{% for levelPriority, list in alerts %}

			{% set level = levelPriority|level  %}
			{% set fgpAlreadyNotRecommended = [] %}
			{% set fgpNotAlreadyNotRecommended = [] %}

			{% for alert in list %}

				{% if alert.alreadyNotRecommended == true %}

					{% set fgpAlreadyNotRecommended = fgpAlreadyNotRecommended|merge([alert.foodGroupParent.name|lower]) %}

				{% else %}

					{% set fgpNotAlreadyNotRecommended = fgpNotAlreadyNotRecommended|merge([alert.foodGroupParent.name|lower]) %}

				{% endif %}

			{% endfor %}

			{% if fgpAlreadyNotRecommended|length > 0  %}
				{% set strFgpAlreadyNotRecommended = '' %}
				{% for fgp in fgpAlreadyNotRecommended %}
					{% if loop.first %}
						{% set strFgpAlreadyNotRecommended = fgp %}
					{% elseif loop.last %}
						{% set strFgpAlreadyNotRecommended = strFgpAlreadyNotRecommended ~ ' et de ' ~ fgp %}
					{% else %}
						{% set strFgpAlreadyNotRecommended = strFgpAlreadyNotRecommended ~ ', de ' ~ fgp %}
					{% endif %}
				{% endfor %}
				{% if strAlreadyNotRecommended == '' %}
					{% set strAlreadyNotRecommended = level.detailedText|format(strFgpAlreadyNotRecommended) %}
				{% elseif loop.last %}
					{% set strAlreadyNotRecommended = strAlreadyNotRecommended ~ ' et ' ~ level.detailedText|format(strFgpAlreadyNotRecommended) %}
				{% else %}
					{% set strAlreadyNotRecommended = strAlreadyNotRecommended ~ ', ' ~ level.detailedText|format(strFgpAlreadyNotRecommended) %}
				{% endif %}
			{% endif %}

			{% if fgpNotAlreadyNotRecommended|length > 0  %}
				{% set strFgpNotAlreadyNotRecommended = '' %}
				{% for fgp in fgpNotAlreadyNotRecommended %}
					{% if loop.first %}
						{% set strFgpNotAlreadyNotRecommended = fgp %}
					{% elseif loop.last %}
						{% set strFgpNotAlreadyNotRecommended = strFgpNotAlreadyNotRecommended ~ ' et de ' ~ fgp %}
					{% else %}
						{% set strFgpNotAlreadyNotRecommended = strFgpNotAlreadyNotRecommended ~ ', de ' ~ fgp %}
					{% endif %}
				{% endfor %}
				{% if strNotAlreadyNotRecommended == '' %}
					{% set strNotAlreadyNotRecommended = level.detailedText|format(strFgpNotAlreadyNotRecommended) %}
				{% elseif loop.last %}
					{% set strNotAlreadyNotRecommended = strNotAlreadyNotRecommended ~ ' et ' ~ level.detailedText|format(strFgpNotAlreadyNotRecommended) %}
				{% else %}
					{% set strNotAlreadyNotRecommended = strNotAlreadyNotRecommended ~ ', ' ~ level.detailedText|format(strFgpNotAlreadyNotRecommended) %}
				{% endif %}
			{% endif %}

		{% endfor %}

		<div>

			{% if strAlreadyNotRecommended != '' %}
				{% set strAlreadyNotRecommended = 'Vous avez dèja dépasser ' ~ strAlreadyNotRecommended %}
			{% endif %}

			{% if strNotAlreadyNotRecommended != '' %}
				{% set strNotAlreadyNotRecommended = 'Son choix vous ferait dépasser ' ~ strNotAlreadyNotRecommended %}
			{% endif %}

			<button data-action="click->modal#open" class="flex items-center advice rounded-full text-sm px-2 font-bold" style="color:{{ ((alerts|first)|first).level.color }}">
					{# <svg class="w-4 h-4 mr-1.5 text-gray-400 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg> #}
    				<span>{{ ((alerts|first)|first).level.text }}</span>
			</button>

			<!-- Modal Container -->
			<div data-modal-target="container" data-action="click->modal#closeBackground keyup@window->modal#closeWithKeyboard" class="hidden animated fadeIn fixed inset-0 overflow-y-auto flex items-center justify-center" style="z-index: 9999;">
			<!-- Modal Inner Container -->
			<div class="max-h-screen w-full max-w-lg relative">
			<!-- Modal Card -->
				<div class="m-1 bg-white rounded shadow">
				<div class="p-8">
					<h2 id="titleAdvice" class="modal-title text-xl mb-4">{{ ((alerts|first)|first).level.text }}</h2>
					<p id="detailsAdviceAlreadyNotRecommended">{{ strAlreadyNotRecommended }}</p>
					<p id="detailsAdviceNotAlreadyNotRecommended">{{ strNotAlreadyNotRecommended }}</p>
					<div class="flex justify-end items-center flex-wrap mt-6">
					<button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded" data-action="click->modal#close">Fermer</button>
					</div>
				</div>
				</div>
			</div>
			</div>


			<!--<span class="show-details-alerts">

				{{ include("meals/pictos/down-arrow-3.xml.twig") }}

			</span>

			<span class="hide-details-alerts">

				{{ include("meals/pictos/up-arrow-3.xml.twig") }}

			</span>-->

		</div>

		<!--<div class="details-alerts">

			{% if strAlreadyNotRecommended != '' %}
				{{ 'Vous avez dèja dépasser ' ~ strAlreadyNotRecommended }}
			{% endif %}

			{% if strNotAlreadyNotRecommended != '' %}
				{{ 'Son choix vous ferait dépasser ' ~ strNotAlreadyNotRecommended }}
			{% endif %}

		</div>-->

	{% endif %}

</div>